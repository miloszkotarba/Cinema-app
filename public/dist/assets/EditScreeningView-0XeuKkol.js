import{_ as z,u as C,r as l,o as F,a as n,c as i,g as $,b as t,l as N,m as u,v as b,C as k,F as v,e as D,t as M,p as O,f as T,B as q,w as W}from"./index-elwunUWg.js";import{a as m}from"./axios-QLjAsgXu.js";import{h as _}from"./ErrorHandler-0YoZ9Z16.js";import{_ as j,a as g}from"./AlertDisplay-ZM8wSD_9.js";import{_ as H}from"./MainPage-GSCsHXFk.js";/* empty css                                                     */import"./logo-djfQEiQd.js";const r=d=>(O("data-v-cf4a3542"),d=d(),T(),d),P={class:"admin-container"},Y={class:"indent"},Z=r(()=>t("header",null,"Edycja seansu",-1)),G={key:0},J={key:1},K={class:"field"},Q=r(()=>t("label",{for:"datetime"},"data seansu",-1)),X={class:"field"},ee=r(()=>t("label",{for:"movie"},"Wybierz film",-1)),te=["value"],ae={class:"field"},oe=r(()=>t("label",{for:"room"},"Wybierz salę",-1)),se=["value"],ne={class:"field"},ie=r(()=>t("label",{for:"advertisementsDuration"},"długość reklam (min)",-1)),re=r(()=>t("button",{type:"submit",class:"submit-btn"},"Zapisz zmiany",-1)),de={__name:"EditScreening",setup(d){const p="https://api.kino-screenix.pl/api/v1/screenings",f="https://api.kino-screenix.pl/api/v1/movies",x="https://api.kino-screenix.pl/api/v1/rooms",h=C().params.id,A=()=>{const e=new Date,s=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),U=String(e.getDate()).padStart(2,"0"),L=String(e.getHours()).padStart(2,"0"),B=String(e.getMinutes()).padStart(2,"0");return`${s}-${a}-${U}T${L}:${B}`},c=l(null),y=l(!0),o=l({date:A(),advertisementsDuration:"",movie:null,room:null}),S=l([]),w=l([]),E=async()=>{try{const e=await m.get(`${p}/${h}`);o.value=e.data}catch(e){_(e,c)}finally{y.value=!1}},R=async()=>{try{if(o.value.advertisementsDuration<0)return g.addAlert("Nieprawidłowa długość reklam","error");const e=o.value.movie._id,s=o.value.room._id;o.value.movie={_id:e},o.value.room={_id:s},await m.patch(`${p}/${h}`,o.value),g.addAlert("Edytowano seans.","success","/admin/seanse")}catch(e){g.addAlert(e.response.data.error,"error"),_(e,c)}},I=async()=>{try{const e=await m.get(f);S.value=e.data.movies}catch(e){_(e,c)}},V=async()=>{try{const e=await m.get(x);w.value=e.data.rooms}catch(e){_(e,c)}};return F(async()=>{await V(),await I(),await E()}),(e,s)=>(n(),i(v,null,[$(j),t("div",null,[t("div",P,[t("div",Y,[Z,y.value?(n(),i("div",G,"Loading...")):(n(),i("div",J,[t("form",{onSubmit:N(R,["prevent"])},[t("div",K,[Q,u(t("input",{type:"datetime-local","onUpdate:modelValue":s[0]||(s[0]=a=>o.value.date=a),required:""},null,512),[[b,o.value.date]])]),t("div",X,[ee,u(t("select",{"onUpdate:modelValue":s[1]||(s[1]=a=>o.value.movie._id=a)},[(n(!0),i(v,null,D(S.value,a=>(n(),i("option",{key:a._id,value:a._id},M(a.title),9,te))),128))],512),[[k,o.value.movie._id]])]),t("div",ae,[oe,u(t("select",{"onUpdate:modelValue":s[2]||(s[2]=a=>o.value.room._id=a)},[(n(!0),i(v,null,D(w.value,a=>(n(),i("option",{key:a._id,value:a._id},M(a.name),9,se))),128))],512),[[k,o.value.room._id]])]),t("div",ne,[ie,u(t("input",{type:"number","onUpdate:modelValue":s[3]||(s[3]=a=>o.value.advertisementsDuration=a),required:""},null,512),[[b,o.value.advertisementsDuration]])]),re],32)]))])])])],64))}},le=z(de,[["__scopeId","data-v-cf4a3542"]]),ye={__name:"EditScreeningView",setup(d){return(p,f)=>(n(),q(H,null,{PageContent:W(()=>[$(le)]),_:1}))}};export{ye as default};
